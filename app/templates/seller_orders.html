{% extends "base.html" %}

{% block content %}
  <br><br>
  <body>
    <a href="{{ url_for('index.index') }}" type="button" class="btn btn-light">Home</a>
    <a href="{{ url_for('users.redirect_to_seller_inventory') }}" type="button" class="btn btn-light">Seller Page</a>
  </body>

  <div class="container">
    <div class="row">
      <!-- Search Form -->
      <div class="col-md-6">
        <form method="GET" id="searchForm">
          <div class="form-group">
            <label for="searchType">Search Type:</label>
            <select class="form-control" name="search_type" id="searchType">
              <option value="order_id" {% if search_type == 'order_id' %}selected{% endif %}>Order ID</option>
              <option value="product_id" {% if search_type == 'product_id' %}selected{% endif %}>Product ID</option>
            </select>
          </div>
          <div class="form-group">
            <label for="searchOrder">Search ID:</label>
            <div class="d-flex">
              <input type="text" class="form-control" name="search_order" id="searchOrder" value="{{ search_order }}" style="width: 300px;">
              <button type="button" class="btn btn-primary ml-2" onclick="submitSearchForm()">Search</button>
            </div>
          </div>
        </form>
      </div>

      <!-- Sort Controls -->
      <div class="col-md-6">
        <form method="GET" id="sortForm">
          <div class="form-group">
            <label for="sortOrder">Sort order:</label>
            <div class="d-flex">
              <select class="form-control" name="sort_order" id="sortOrder">
                <option value="asc" {% if sort_order == 'asc' %}selected{% endif %}>Ascending</option>
                <option value="desc" {% if sort_order == 'desc' %}selected{% endif %}>Descending</option>
              </select>
              <button type="button" class="btn btn-primary ml-2" onclick="submitSortForm()">Sort</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <br><br>
  <h2>Seller's Orders:</h2>
  <table class='table table-hover table-bordered container'>
    <thead class="thead-dark">
      <tr>
        <th scope="col">Order ID</th>
        <th scope="col">Product ID</th>
        <th scope="col">Quantity</th>
        <th scope="col">Price</th>
        <th scope="col">Fulfilled</th>
      </tr>
    </thead>
    <tbody>
      {% for order in inventory %}
        <tr>
          <td>{{ order.id }}</td>
          <td>{{ order.pid }}</td>
          <td>{{ order.qty }}</td>
          <td>{{ order.price }}</td>
          <td>{{ "Yes" if order.fulfilled else "No" }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <nav aria-label="Page navigation">
    <ul class="pagination">
      {% set total_pages = (total // per_page) + (1 if total % per_page > 0 else 0) %}
      {% for p in range(1, total_pages + 1) %}
      <li class="page-item {% if p == page %}active{% endif %}">
        <a class="page-link" href="{{ url_for('seller_inventory.past_seller_orders', uid=uid, page=p) }}">{{ p }}</a>
      </li>
      {% endfor %}
    </ul>
  </nav>

  <script>
    function submitSearchForm() {
      document.getElementById("searchForm").action = "{{ url_for('index.index') }}";
      document.getElementById("searchForm").submit();
    }

    function submitSortForm() {
      document.getElementById("sortForm").action = "{{ url_for('index.index') }}";
      document.getElementById("sortForm").submit();
    }

  </script>

{% endblock %}
